#add-inventory-item.table-responsive
  = form_for [:admin, product, product.inventory_items.build.tap { |item| item.inventory_entries.build(recorded_at: Date.today) }], remote: true, method: :post do |f|
    = f.hidden_field :product_id
    = f.fields_for :inventory_entries do |ff|
      %table.table.table-loose
        %tbody
          %tr
            %td.col-xs-3
              = f.text_field :code, class: 'form-control'
            %td.col-xs-3
              = f.select :inventory_id, current_store.inventories.map { |i| [i.to_s, i.id] }, {}, {placeholder: col(InventoryItem, :inventory_id)}
            %td.col-xs-2
              = ff.number_field :on_hand, value: 0, class: 'form-control text-right'
              = ff.hidden_field :reserved, value: 0
              = ff.hidden_field :pending, value: 0
            %td.col-xs-2
            %td.col-xs-2= ff.text_field :value, value: product.cost_price, placeholder: col(InventoryEntry, :value), class: 'form-control text-right'
          %tr.subrow
            %td
              = ff.text_field :recorded_at, class: 'form-control', data: {provide: 'datepicker', 'date-format': 'yyyy-mm-dd', 'date-language': I18n.locale}
            %td{colspan: 3}= ff.text_field :note, placeholder: col(InventoryEntry, :note), class: 'form-control'
            %td.actions
              = f.button t('.submit'), class: 'btn btn-default' do
                = icon('check')

  :coffee
    $('#inventory_item_inventory_id').selectize
      dropdownParent: 'body'
